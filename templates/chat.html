<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<html>
<head>
  
</head>
<style>
@import url(https://fonts.googleapis.com/css?family=Oswald:400);
body,html {
  padding: 0;
  margin-bottom: 0%;
  height: 100vh;
  background: #E6EAEA;
  font-family: "proxima-nova",  "Source Sans Pro", sans-serif;
  font-size: 2.8vh;
}
.navigation {
  width: 100vw;
}
.chats{
  text-align: left;
  border-width: 0.1px 0px;
  background:  #2c3e50;
  color: #f5f5f5;
}
.chats:hover{
  background: #32465a;
}
.chats1{
  text-align: left;
  border-width: 0.1px 0px;
  background:  #32465a;
  color: #f5f5f5;
}
.button2 {
	float: right;
  color:#32465a;
  background: #f5f5f5;
  margin-top: 1vh;
  cursor: pointer;
}
.button2:hover{
  opacity: .9;
  color:#f5f5f5;
  background: #435f7a;
}
::-webkit-scrollbar {
  width: 5px;
  cursor: pointer;
}
::-webkit-scrollbar-track {
  width: 5px;
  background:  #435f7a ;
}
::-webkit-scrollbar-thumb {
  width: 1em;
  background-color:#2c3e50;
  outline: 1px solid slategrey;
  border-radius: 1rem;
  cursor: pointer;
}

.row{
  width:101vw;
  height:100vh;
  background: #E6EAEA;
}

.search{
  height:10vh;
  background-color:#2c3e50;
}
.search1{
  height:10vh;
  background-color:#f5f5f5;
}

.column{
  height: 100%;
  margin:0;
  position: relative;
}
.column1{
  height: 100vh;
  margin:0;
  background: #2c3e50;
}
.txt{
  color: #2c3e50;
  font-size:3.5vh;
  font-weight: 530;
}
.txt1{
  font-weight: 400;
}
.txt2{
  font-style: italic;
  font-size:2.7vh;
  font-weight: 300;
}
.messages-box{
  height: 90vh;
  overflow-y: scroll;
}
.chatbox{
  display: flex;
  flex-direction: column-reverse;
  height: 80vh;
  overflow-y: scroll;
  background: #E6EAEA;
  margin-left:0; 
}
.current-chat{
  color: #fff;
}
.rounded-lg {
  border-radius: 0.5rem;
}
input::placeholder {
  font-size: 2.8vh;
  color: #999;
}

.names{
  width:100%;
  padding:10px;
  border-width: 1px;
  font-size:3vh;
  color:#2c3e50;
}
.dropbtn {
  color: #E6EAEA;
  padding: 16px;
  border: none;
}
button{
  cursor: pointer;
}
#myInput {
  box-sizing: border-box;
  padding: 14px 20px 12px 20px;
  border:none;
}

.searchbox{
  height:7vh;
  width:20vw;
  color: #f5f5f5;
  background: #2c3e50;
}
.searchbox:focus{
  background: #32465a;
}
.searchbox::placeholder { 
  color:#f5f5f5;
}
.dropdown {
  position: relative;
  display: inline-block;
}
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #435f7a;
  width: 20vw;
  max-height:45vh;
  overflow: auto;
  border: 1px solid #ddd;
  z-index: 1;
}

.right{
  max-width: 69%;
}
.left{
  max-width: 70%;
}
.dropdown a:hover {
  background-color: #ddd;
}
.show {
  display: block;
}
.msg-button{
  background:#435f7a;
  color:#f5f5f5;
  width:100%;
  height:100%;
}
.msg-button:hover{
  color:rgb(54, 204, 241);
}
.icon{
  margin-top: 2%;
}
.icon1{
  margin-top: 5%;
}
.icon2{
  float: left;
  color:#f5f5f5;
  font-weight: 400;
  margin-top: 1.5vh;
}
.chat-txt{
  font-family: "proxima-nova",  "Source Sans Pro", sans-serif;
  font-size:2.8vh;
  font-weight: 300;
}
.sender{
  background:#435f7a;
  border-radius: 20px;
}
.reciever{
  border-radius: 20px;
}
.message{
  position: absolute;
  bottom: 0;
}
</style>

<script>
  function myFunction() {
  document.getElementById("myDropdown").classList.toggle("show");
}

window.onclick = function(event) {
  if (!event.target.matches('.searchbox')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
if ( window.history.replaceState ) {
  window.history.replaceState( null, null, '/chat/{{var}}' );
}

$(window).resize(function() {
if ($(this).width() < 1024) {
  $('.column1').hide();
} else {
  $('.column1').show();
}
});

function filterFunction() {
  var input, filter, ul, li, a, i;
  input = document.getElementById("myInput");
  filter = input.value.toUpperCase();
  div = document.getElementById("myDropdown");
  a = div.getElementsByTagName("button");
  for (i = 0; i < a.length; i++) {
    txtValue = a[i].textContent || a[i].innerText;
    if (txtValue.toUpperCase().indexOf(filter) > -1) {
      a[i].style.display = "";
    } else {
      a[i].style.display = "none";
    }
  }
}  
</script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://kit.fontawesome.com/ce3fc7af3b.js" crossorigin="anonymous"></script>

<div class="row" >
  <!-- Users box-->
  <div class="column1 col-4 px-1">
        <div class="search px-4 py-2">
          <form method="post" action='/chat/{{var}}'>
            <i class="icon2 fas fa-search py-1 px-2"></i>
            <div class="dropdown">
   <input onclick="myFunction()" class='searchbox' type="text" placeholder="Search" id="myInput" onkeyup="filterFunction()"autocomplete="off">
  <div id="myDropdown" class="dropdown-content">
    {% for member in users_name %}
    <div><button class="names" name='action' value={{member}}>{{member}}</button></div>
    {% endfor %}
  </div>
</div>
      <button type="submit" title='logout' class="button2 px-2 py-1 rounded" name ='action' value="logout">
  	<i class='fas fa-sign-out-alt'></i></button>
  </form>
            
        </div>
        <form method="post" action='/chat/{{var}}'>
          <div class="messages-box">
            <div class="list-group rounded-0">
              {%for chat in user_chats %}
              {% if current_chat!=''and chat[0]==current_chat %}
              <button name='action1' value={{chat[0]}} class=" chats1 px-4 py-2 light rounded-0">
              {%else%}
              <button name='action1' value={{chat[0]}} class=" chats px-4 py-2 light rounded-0">
              {%endif%}
                <div class="media"><i class="icon fas fa-user"></i>
                  <div class="media-body ml-4">
                    <div class="d-flex align-items-center justify-content-between mb-1">
                      <h6 class="mb-0">{{chat[0]}}</h6>
                      {%if chat[3]==curr_date[0] and chat[4]==curr_date[1] and chat[5]==curr_date[2]%}
                      <small class="txt1 small">{{chat[2]}}</small>
                      {%else%}<small class="txt1 small ">{{chat[3]}} {{chat[4]}} {{chat[5]}}</small>
                      {%endif%}
                    </div>
                    {%if chat[1]|length >=35 %}
                    <p class="txt2 mb-0 text-small">{{chat[1][:35]}}...</p>
                    {%else%}
                    <p class="txt2 mb-0 text-small">{{chat[1]}}</p>
                    {%endif%}
                  </div>
                </div>
              </button>
              {%endfor%}
            </div>
          </div>
        </form>
      
    </div>
    
    <div class="column col-8 px-0">
          <div class="search1 px-4 py-2">
            {%if current_chat!='' %}
            <p class="txt mb-0 py-1"><i class="px-2 fas fa-user"></i>   {{current_chat}}
          </p>
            {%else%}<p class="txt mb-0 px-3 py-1">Welcome {{var}}</p>{%endif%}
        </div>
      <!-- Chat Box-->
      <div class="px-4 py-2 chatbox ">
        <!-- Sender Message-->
        {%if current_chat!='' %}
        {%for chat in chats%}
        {%if chat[0] == var %}
        <div class="right media  ml-auto mb-3">
          <div class="media-body mr-4">
            <div class="reciever bg-light py-2 px-3 mb-2">
              <p class="chat-txt text-small mb-0 ">{{chat[1]}}</p>
            </div>
            <p class="chat-txt small text-muted text-right">{{chat[2]}} | {{chat[3]}}</p>
          </div>
        </div>
        {%else%}
        <div class="left media mr-auto mb-3"><i class="icon1 fas fa-user"></i>
          <div class="media-body ml-3">
            <div class="sender py-2 px-3 mb-2">
              <p class="chat-txt text-small mb-0 text-white">{{chat[1]}}</p>
            </div>
            <p class="chat-txt small text-muted text-left">{{chat[2]}} | {{chat[3]}}</p>
          </div>
        </div>
        {%endif%}
        {% endfor %}
        
      </div>
      <!-- Typing area -->
      <form method="post" action='/chat/{{var}}'>
        <div class="message input-group" >
          <input type="text" autocomplete="off" name='sent-msg' placeholder="Type a message" aria-describedby="button-addon2" class="form-control rounded-0 border-0 py-3 bg-light" required>
          <div class="input-group-append">
            <button id="button-addon2" name='sent-msg' type="submit" class="button msg-button"> <i class="fa fa-paper-plane px-2"></i></button>
          </div>
        </div>
      </form>
      
      {%endif%}
    </div>
</div>

</html>